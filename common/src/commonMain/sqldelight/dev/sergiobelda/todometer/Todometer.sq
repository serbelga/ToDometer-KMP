import dev.sergiobelda.todometer.common.model.Tag;
import dev.sergiobelda.todometer.common.model.TaskState;

CREATE TABLE TaskListEntity (
    id TEXT PRIMARY KEY NOT NULL,
    name TEXT NOT NULL,
    description TEXT NOT NULL,
    sync INTEGER AS Boolean NOT NULL DEFAULT 0
);

CREATE TABLE TaskEntity (
    id TEXT PRIMARY KEY NOT NULL,
    title TEXT NOT NULL,
    description TEXT,
    state TEXT AS TaskState NOT NULL,
    tasklist_id TEXT NOT NULL,
    tag TEXT AS Tag NOT NULL,
    sync INTEGER AS Boolean NOT NULL DEFAULT 0,
    FOREIGN KEY(tasklist_id) REFERENCES TaskListEntity(id) ON UPDATE CASCADE ON DELETE CASCADE
);

-------------------- Task

selectTask:
SELECT *
FROM TaskEntity
WHERE id = ?;

selectTasksByTaskListId:
SELECT *
FROM TaskEntity
WHERE tasklist_id = ?; ---- ORDER BY state ASC;

selectAllTasks:
SELECT *
FROM TaskEntity;

insertOrReplaceTask:
INSERT OR REPLACE INTO TaskEntity
(id, title, description, state, tasklist_id, tag, sync)
VALUES (?, ?, ?, ?, ?, ?, ?);

updateTask:
UPDATE TaskEntity
SET
    title = ?,
    description = ?,
    tag = ?
WHERE id = ?;

updateTaskSync:
UPDATE TaskEntity
SET
    sync = ?
WHERE id = ?;

updateTaskState:
UPDATE TaskEntity
SET
    state = ?
WHERE id = ?;

deleteTask:
DELETE FROM TaskEntity
WHERE id = ?;

-------------------- TaskList

selectTaskList:
SELECT *
FROM TaskListEntity
WHERE id = ?;

selectAllTaskLists:
SELECT *
FROM TaskListEntity;

insertTaskList:
INSERT INTO TaskListEntity
(id, name, description, sync)
VALUES (?, ?, ?, ?);

insertOrReplaceTaskList:
INSERT OR REPLACE INTO TaskListEntity
(id, name, description, sync)
VALUES (?,?, ?, ?);

updateTaskList:
UPDATE TaskListEntity
SET
    name = ?,
    description = ?,
    sync = ?
WHERE id = ?;

deleteTaskList:
DELETE FROM TaskListEntity
WHERE id = ?;
